<h1>Список користувачів</h1>

<table border="1" cellpadding="5">
    <thead>
        <tr>
            <th>ID</th>
            <th>Ім’я</th>
            <th>Вік</th>
            <th>Дії</th>
        </tr>
    </thead>
    <tbody id="table"></tbody>
</table>

<script>
// --- Завантаження списку ---
async function loadUsers() {
    const res = await fetch("/api/users");
    const users = await res.json();

    const tbody = document.getElementById("table");
    tbody.innerHTML = "";

    users.forEach(u => {
        tbody.innerHTML += `
            <tr>
                <td>${u.id}</td>
                <td><input value="${u.name}" id="name-${u.id}"></td>
                <td><input value="${u.age}" id="age-${u.id}" type="number"></td>
                <td>
                    <button onclick="updateUser(${u.id})">Зберегти</button>
                    <button onclick="deleteUser(${u.id})">Видалити</button>
                </td>
            </tr>
        `;
    });
}

// --- Оновлення ---
async function updateUser(id) {
    const name = document.getElementById(`name-${id}`).value;
    const age = document.getElementById(`age-${id}`).value;

    await fetch(`/api/users/${id}`, {
        method: "PUT",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({name, age})
    });

    loadUsers();
}

// --- Видалення ---
async function deleteUser(id) {
    await fetch(`/api/users/${id}`, {
        method: "DELETE"
    });

    loadUsers();
}

loadUsers();
</script>

<a href="/">Додати нового користувача</a>
